---
import '/src/styles/reset.css';
import '/src/styles/global.css';

import Layout from '../../layouts/Layout.astro';
import Image from 'astro/components/Image.astro';

import { getCollection } from "astro:content";
import type { CollectionEntry, CollectionKey } from "astro:content";
import ProjectCard from '../../components/projectCard.astro';

export async function getStaticPaths() {
    const alleProsjekter: CollectionEntry<'prosjekter'>[] = await getCollection('prosjekter')

    return alleProsjekter.map(prosjekt => ({
        params: {
            slug: prosjekt.slug
        },
        props: {prosjekt}
    }));
}

const { prosjekt } = Astro.props;

const { Content } = await prosjekt.render();

const images = import.meta.glob<{ default: ImageMetadata }>('/src/images/projects/*.{jpeg,jpg,png,gif}');
if (!images[prosjekt.data.mainImage]) throw new Error(`"${prosjekt.data.mainImage}" does not exist in glob: "src/images/projects/*.{jpeg,jpg,png,gif}"`);
---

<Layout title="Prosjekt test">

    <Image src={images[prosjekt.data.mainImage]()} alt={prosjekt.data.altText} />

    <div class="projectWrapper">
        <h1>{prosjekt.data.tittel}</h1>

        <div class="projectMeta">

        </div>

        <Content/>
    </div>

</Layout>

<style is:global>

    body{
        background-color: var(--dark);
        
    }

    .projectWrapper{
        margin-bottom: 7rem;
    }
    p, h1, h2, h3, .projectWrapper div, .projectWrapper a{
        margin: 1em auto;
        max-width: 55rem;
        color: white;
    }

    /* forsøk på å flytte underoverskiftene til venstre marg */
    /* h2 {
        color: red;
        font-size: 1.5em;
        margin-top: 0;

    } */

    .projectWrapper a:hover{
        color: var(--yellow);
    }

    p {
        font-size: 1.5em;
    }

    h1{
        font-size: 3em;
    }

    h2{
        font-size: 1.15em;
    }

    .projectMeta {
        width: 100%;
        height: 20em;
        background-color: gray;
    }

    p :has(img) {
        border: 2px solid blue;
        max-width: 70rem;
    }

    img{
        height: auto;
    }
    .projectWrapper img {
        max-width: 70rem;
        margin-left: auto;
        margin-right: auto;
    }

</style>